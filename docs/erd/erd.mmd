erDiagram
    users {
        UUID id PK
        BOOLEAN email_verified
        VARCHAR profile_image_url
        TEXT bio
        TIMESTAMP last_login_at
        TIMESTAMP ban_until
        TEXT ban_reason
    }

    files {
        UUID id PK
        UUID uploader_id FK
        VARCHAR original_name
        VARCHAR stored_name
        BIGINT file_size
        VARCHAR mime_type
        VARCHAR s3_url
        ENUM file_type
        TIMESTAMP created_at
    }

    post_files {
        SERIAL id PK
        UUID post_id FK
        UUID file_id FK
        INT sort_order
    }

    posts {
        UUID id PK
        INT view_count
        INT comment_count
        ENUM status
        BOOLEAN is_pinned
    }

    notifications {
        UUID id PK
        UUID user_id FK
        ENUM type
        VARCHAR title
        TEXT content
        UUID related_id
        ENUM related_type
        BOOLEAN is_read
        TIMESTAMP created_at
        TIMESTAMP read_at
    }

    reports {
        UUID id PK
        UUID reporter_id FK
        UUID target_id
        ENUM target_type
        ENUM reason
        TEXT description
        ENUM status
        UUID handler_id FK
        TEXT resolution
        TIMESTAMP created_at
        TIMESTAMP resolved_at
    }

    tags {
        SERIAL id PK
        VARCHAR name UNIQUE
        INT usage_count
        TIMESTAMP created_at
    }

    post_tags {
        SERIAL id PK
        UUID post_id FK
        INT tag_id FK
    }

    user_activity_logs {
        UUID id PK
        UUID user_id FK
        ENUM action_type
        UUID target_id
        JSONB metadata
        TIMESTAMP created_at
    }

    chat_sessions {
        UUID id PK
        VARCHAR title
        TIMESTAMP last_message_at
        INT message_count
    }

    %% Relationships
    files ||--o{ users : "uploader_id"
    post_files ||--o{ posts : "post_id"
    post_files ||--o{ files : "file_id"
    notifications ||--o{ users : "user_id"
    reports ||--o{ users : "reporter_id"
    reports ||--o{ users : "handler_id"
    post_tags ||--o{ posts : "post_id"
    post_tags ||--o{ tags : "tag_id"
    user_activity_logs ||--o{ users : "user_id"
